geom_text(data=subset(plotData, values == maxDip), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("\nalpha==",format(alpha/num_comparisons_dip, digits=1),"        "),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, values == maxDip), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("\n alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, values == maxDip), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("'\n'alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, values == maxDip), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("'\nw' ~alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>(bonferroni_cutoff_dip*10))), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = NA), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>(bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = NA), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>(bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = NA), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(aes(xintercept = maxDip), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),xintercept = values, color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),xintercept = maxDip, color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip*10)),xintercept = maxDip, color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>(bonferroni_cutoff_dip*10))),xintercept = maxDip, color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values > maxDip & values>bonferroni_cutoff_dip)),xintercept = maxDip, color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),xintercept = 2, color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values > maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
bonferroni_cutoff_dip
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
bonferroni_cutoff_dip<-8
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
bonferroni_cutoff_dip<-6
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(expand=c(0, 1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("white")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
dipPlot <- ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 5, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 5, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 5, vjust = 1, hjust = 1)
pdf(paste0("./plots/s_distributions/",paste0(subpop,collapse="_"), plotname, ".pdf"), width=4, height=4)
print(dipPlot)
dev.off()
dipPlot <- ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 3, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 3, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 3, vjust = 1, hjust = 0)
pdf(paste0("./plots/s_distributions/",paste0(subpop,collapse="_"), plotname, ".pdf"), width=4, height=4)
print(dipPlot)
dev.off()
}
dipPlot <- ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
#         scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 3, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 3, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 3, vjust = 1, hjust = 0)
pdf(paste0("./plots/s_distributions/",paste0(subpop,collapse="_"), plotname, ".pdf"), width=4, height=4)
print(dipPlot)
dev.off()
dipPlot <- ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 3, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 3, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 3, vjust = 1, hjust = 0)
pdf(paste0("./plots/s_distributions/",paste0(subpop,collapse="_"), plotname, ".pdf"), width=4, height=4)
print(dipPlot)
dev.off()
}
ggplot(plotData, aes(values)) +
geom_histogram(color="red",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 3, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 3, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 3, vjust = 1, hjust = 0)
ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 3, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 3, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 3, vjust = 1, hjust = 0)
dipPlot <- ggplot(plotData, aes(values)) +
geom_histogram(color="blue",binwidth=.01,fill=I("blue")) +
ggtitle(paste0(subpop,collapse="_"))  + xlab("Similarity score") +
scale_x_continuous(limits=c(0, maxDip+1)) +
theme_bw() +
theme(plot.title = element_text(size=40), axis.title.x = element_text(size = 10), axis.title.y = element_blank(), axis.text.y=element_blank()) +
geom_vline(xintercept = bonferroni_cutoff_dip, color="red", linetype="dotted") +
geom_vline(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)),aes(xintercept = values), color="blue", linetype="dotted") +
geom_vline(xintercept = median(gsm[row(gsm)!=col(gsm)]), color="red", linetype=1) +
geom_text(data=subset(plotData, values > bonferroni_cutoff_dip), aes(values,label=pairs), y=0, angle = 80, hjust=0, size=3) +
geom_text(data=subset(plotData, (values == maxDip & values>bonferroni_cutoff_dip)), x=maxDip, y=Inf, label=paste0("hat(phi)==", round(topValuesKinship[1],3),"  "),parse = TRUE, color="blue", angle = 0, size = 3, vjust = 1, hjust = 0) +
annotate("text", x=bonferroni_cutoff_dip, y=Inf, label=paste0("alpha==",format(alpha/num_comparisons_dip, digits=1)),parse = TRUE, color="red", angle = 0, size = 3, vjust = 1, hjust = 1) +
annotate("text", x=median(gsm[row(gsm)!=col(gsm)]), y=Inf, label=paste0("m=",round(median(gsm[row(gsm)!=col(gsm)]),3)," "), color="red", angle = 0, size = 3, vjust = 1, hjust = 0)
pdf(paste0("./plots/s_distributions/",paste0(subpop,collapse="_"), plotname, ".pdf"), width=4, height=4)
print(dipPlot)
dev.off()
outputDir<-"testDir"
dir.create(outputDir)
dir.create(paste0("~/1000GP/plots/",outputDir))
dir.create(paste0("~/1000GP/plots/s_distributions/",outputDir))
